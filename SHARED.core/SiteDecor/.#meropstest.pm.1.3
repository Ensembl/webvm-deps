#########
# perl header & footer module designed for mod_perl use
# Author: rmp
# Maintainer: rmp
# Date: 2002-02-26
#

package SiteDecor::meropstest;
use strict;
use base qw(SiteDecor);

sub init_defaults {
  my $self = shift;
  my $def  = {
	      "author"     => 'webmaster',
	      "decor"      => 'full',
	      'bannercase' => 'ucfirst',
	     };
  $self->merge($def);
}

sub html_headers {
  my $self = shift;
  my $html_headers = qq(
<html>
  <head>
    <title>MEROPS - the Peptidase Database</title>
    <link rel="stylesheet" type="text/css" href="/css/main.css" />
  </head>
  <body>

    <div class="content">\n);
  return $html_headers;
}

sub site_headers {
  my $self = shift;
  my $site_headers = "";

  if(defined $self->{'banner'}) {
    my $banner = "";
    if($self->{'bannercase'} eq "uc") {
      $banner = uc($self->{'banner'});
    } elsif($self->{'bannercase'} eq "ucfirst") {
      $banner = ucfirst($self->{'banner'});
    } else {
      $banner = lc($self->{'banner'});
    }
    $site_headers .= $self->site_banner($banner);
  }

  return $site_headers;
}

sub site_banner {
  my ($self, $heading) = @_;

  return qq(<h1>$heading</h1>);
}

sub get_time {
  my ( $time ) = @_;
  my ( $sec, $min, $hour, $mday, $mon, $year, $wday, $yday) = gmtime $time; #gmtime($time);
  my $month = qw (January February March April May June July August September October November December)[$mon];
     $year = $year + 1900;
  return sprintf '%2d-%s-%4d',$mday,$month,$year;
}

sub html_footers {
  my $self = shift;

  my $lastmod = q();
  my $req_uri = $ENV{'REQUEST_URI'} || q();

  if($ENV{'LAST_MODIFIED'}) {
    $lastmod = qq(Last Modified $ENV{'LAST_MODIFIED'});

  } else {
    #########
    # Look for the request_uri document
    #
    my ($fn) = "$ENV{'DOCUMENT_ROOT'}/$req_uri" =~ m|([a-z\d\./_]+)|mix;

    #########
    # If that doesn't exist try the script_filename
    #
    if($fn && !-e $fn) {
      ($fn) = $ENV{'SCRIPT_FILENAME'}||q() =~ m|([a-z\d\./_]+)|mix;
    }

    if($fn && -e $fn) {
      my ($mtime)     = (stat $fn)[9];
      if ($mtime) {
        $lastmod = 'Page created '. get_time($mtime);
      }
    }
  }
   
  return qq(
      <div class="footer">
        <p class="right">$lastmod</p>
        <p class="left">Funding from the <a href="http://www.wellcome.ac.uk">Wellcome Trust</a></p>
        <p class="middle">&copy; 2008 WTSI<br><a href="/about/about_10.htm">Terms of use</a></p>
      </div>
    </div><!-- end class content -->
    <div class="sidebar">
      <p class="title"><a href="/index.html">MEROPS</a></p>
      <a class="switch" href="/inhibitors">Switch to<br/>Inhibitors</a>
      <ul>
        <li>Peptidase
          <ul>
            <li><a href="/cgi-bin/name_index?id=P;action=A">Name</a>
            <li><a href="/cgi-bin/make_id_index?type=peptidase;action=A">Identifier</a>
            <li><a href="/cgi-bin/make_gene_index?type=peptidase;action=A">Gene name</a>
            <li><a href="/cgi-bin/make_organism_index?type=P;id=A">Organism</a>
          </ul>
        </li>
        <li><a href="/cgi-bin/make_family_index?type=peptidase">Family</a>
        <li><a href="/cgi-bin/make_clan_index?type=peptidase">Clan</a>
      </ul>
      <div class="bigtext">
        <p><a href="search_page.htm">SEARCHES</a></p>
        <p class="blast"><a href="/cgi-bin/blast/submitblast/merops/advanced">BLAST<br>MEROPS</a></p>
        <p class="blast"><a href="/cgi-bin/merops_upload">BATCH<br>BLAST</a></p>
        <p><a href="submissions.htm">SUBMISSIONS</a></p>
      </div>
      <ul>
        <li>Other<br/>information
          <ul>
            <li><a href="whatsnew.htm">What's New</a>
            <li><a href="about/about_frm.htm">About</a>
            <li><a href="/cgi-bin/image_gallery?type=P">Images</a>
            <li><a href="/cgi-bin/make_est_index?id=mainpage;type=peptidase">EST cell lines</a>
            <li><a href="/cgi-bin/make_unseqpep_index">Unsequenced</a>
            <li><a href="/cgi-bin/make_compgen_index?id=P">Genomes</a>
            <li><a href="/cgi-bin/make_statistics_index?type=peptidase">Statistics</a>
            <li><a href="/cgi-bin/make_distribution_index?type=peptidase">Distribution</a>
            <li><a href="/cgi-bin/make_peplist_index?action=A">PepList</a>
            <li><a href="dnld_list.htm">Download</a>
            <li><a href="community.htm">Community</a>
          </ul>
        </li>
      </ul>
    </div><!-- end sidebar -->
  </body>
</html>\n);
}

1;
