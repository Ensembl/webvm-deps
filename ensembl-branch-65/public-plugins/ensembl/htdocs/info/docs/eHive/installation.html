<HTML>
<HEAD>
<META NAME="order" CONTENT="2" />
<META NAME="navigation" CONTENT="eHive production system" />
<TITLE>eHive production system - Installation</TITLE>
</HEAD>

<BODY>
<H1>eHive production system - Installation</H1>

<H2>Download and install the necessary external software</H2>

<P>Note: You may have these packages already installed in your system.</P>

<OL>
<LI>
<A HREF="http://www.perl.com/download.csp">Perl 5.6 or higher</A>, since eHive code is written in Perl.
</LI>
<LI>
<A HREF="http://dev.mysql.com/downloads/">MySQL 5.1 or higher</A>
<BR />eHive keeps its state in a MySQL database, so you will need
<UL>
<LI>a MySQL server installed on the machine where you want to maintain the state and</LI>
<LI>MySQL clients installed on the machines where the jobs are to be executed.</LI>
</UL>
MySQL version 5.1 or higher is recommended to maintain compatibility with Compara pipelines.
</LI>
<LI>
<A HREF="http://dbi.perl.org/">Perl DBI API</A>
<BR />Perl database interface that includes API to MySQL
</LI>
</OL>

<H2>Download and install essential and optional packages from BioPerl and EnsEMBL CVS</H2>
<OL>
<LI>
Create a directory for the source code.
<BR />It is advised to have a dedicated directory where EnsEMBL-related packages will be deployed. Unlike DBI modules that can be installed system-wide by the system administrator, you will benefit from full (read+write) access to the EnsEMBL files/directories, so it is best to install them under your home directory. For example,

<PRE>$ mkdir $HOME/ensembl_main</PRE>

It will be convenient to set a variable pointing at this directory for future use:
<UL>
<LI>
using bash syntax (for best results, append this line to your ~/.bashrc configuration file):
<PRE>$ export ENSEMBL_CVS_ROOT_DIR="$HOME/ensembl_main"</PRE>
</LI>
<LI>
using [t]csh syntax (for best results, append this line to your ~/.cshrc or ~/.tcshrc configuration file):
<PRE>$ setenv ENSEMBL_CVS_ROOT_DIR "$HOME/ensembl_main"</PRE>
</LI>
</UL>
</LI>

<LI>
Change into your ensembl codebase directory:
<PRE>$ cd $ENSEMBL_CVS_ROOT_DIR</PRE>
</LI>
<LI>
Log into the BioPerl CVS server (using "cvs" for password):
<PRE>$ cvs -d :pserver:cvs@code.open-bio.org:/home/repository/bioperl login</PRE>
</LI>
<LI>
Export the bioperl-live package:
<PRE>$ cvs -d :pserver:cvs@code.open-bio.org:/home/repository/bioperl export bioperl-live</PRE>
</LI>
<LI>
Log into the EnsEMBL CVS server at Sanger (using "CVSUSER" for password):
<PRE>$ cvs -d :pserver:cvsuser@cvs.sanger.ac.uk:/cvsroot/ensembl login
Logging in to :pserver:cvsuser@cvs.sanger.ac.uk:2401/cvsroot/ensembl
CVS password: CVSUSER</PRE>
</LI>
<LI>
Export ensembl and ensembl-hive CVS modules:
<PRE>$ cvs -d :pserver:cvsuser@cvs.sanger.ac.uk:/cvsroot/ensembl checkout ensembl
$ cvs -d :pserver:cvsuser@cvs.sanger.ac.uk:/cvsroot/ensembl checkout ensembl-hive</PRE>
</LI>
<LI>
In the likely case you are going to use eHive in the context of Compara pipelines, you will also need to install ensembl-compara:
<PRE>$ cvs -d :pserver:cvsuser@cvs.sanger.ac.uk:/cvsroot/ensembl checkout ensembl-compara</PRE>
</LI>
<LI>
Add new packages to the PERL5LIB variable:
<UL>
<LI>using bash syntax (for best results, append these lines to your ~/.bashrc configuration file):
<PRE>$ export PERL5LIB=${PERL5LIB}:${ENSEMBL_CVS_ROOT_DIR}/bioperl-live
$ export PERL5LIB=${PERL5LIB}:${ENSEMBL_CVS_ROOT_DIR}/ensembl/modules
$ export PERL5LIB=${PERL5LIB}:${ENSEMBL_CVS_ROOT_DIR}/ensembl-hive/modules
$ export PERL5LIB=${PERL5LIB}:${ENSEMBL_CVS_ROOT_DIR}/ensembl-compara/modules # optional but recommended, see previous point.
</PRE>
</LI>
<LI>
using [t]csh syntax (for best results, append these lines to your ~/.cshrc or ~/.tcshrc configuration file):
<PRE>$ setenv PERL5LIB  ${PERL5LIB}:${ENSEMBL_CVS_ROOT_DIR}/bioperl-live
$ setenv PERL5LIB  ${PERL5LIB}:${ENSEMBL_CVS_ROOT_DIR}/ensembl/modules
$ setenv PERL5LIB  ${PERL5LIB}:${ENSEMBL_CVS_ROOT_DIR}/ensembl-hive/modules
$ setenv PERL5LIB  ${PERL5LIB}:${ENSEMBL_CVS_ROOT_DIR}/ensembl-compara/modules # optional but recommended, see previous point.
</PRE>
</LI>
</UL>
</LI>
</OL>

<H2>Useful files and directories of the eHive repository</H2>
<OL>

<LI>In ensembl-hive/scripts we keep perl scripts used for controlling the pipelines.
    Adding this directory to your $PATH may make your life easier.
    <UL>
    <LI><B>init_pipeline.pl</B> is used to create hive databases, populate hive-specific and pipeline-specific tables and load data</LI>
    <LI><B>beekeeper.pl</B>     is used to run the pipeline; send 'Workers' to the 'Meadow' to run the jobs of the pipeline</LI>
    </UL>
</LI>

<LI>In ensembl-hive/modules/Bio/EnsEMBL/Hive/PipeConfig we keep example pipeline configuration modules that can be used by <B>init_pipeline.pl</B> .
    A PipeConfig is a parametric module that defines the structure of the pipeline.
    That is, which analyses with what parameters will have to be run and in which order.
    The code for each analysis is contained in a RunnableDB module.
    For some tasks bespoke RunnableDB have to be written, whereas some other problems can be solved by only using 'universal buliding blocks'.
    A typical pipeline is a mixture of both.
</LI>

<LI>In ensembl-hive/modules/Bio/EnsEMBL/Hive/RunnableDB we keep 'universal building block' RunnableDBs:
    <UL>
    <LI><B>SystemCmd.pm</B>  is a parameter substitution wrapper for any command line executed by the current shell
    </LI>

    <LI><B>SqlCmd.pm</B>     is a parameter substitution wrapper for running any MySQL query or a session of linked queries
                    against a particular database (eHive pipeline database by default, but not necessarily)
    </LI>

    <LI><B>JobFactory.pm</B> is a universal module for dynamically creating batches of same analysis jobs (with different parameters)
                    to be run within the current pipeline
    </LI>
    </UL>
</LI>

<LI>In ensembl-hive/modules/Bio/EnsEMBL/Hive/RunnableDB/LongMult we keep bespoke RunnableDBs for long multiplication example pipeline.
</LI>
</OL>

<P><A HREF="index.html">Back</A></P>
</BODY>
</HTML>
